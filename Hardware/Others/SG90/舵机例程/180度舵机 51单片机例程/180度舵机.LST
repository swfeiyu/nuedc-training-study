C51 COMPILER V9.01   180度舵_                                                             10/27/2022 08:47:38 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE 180度舵_
OBJECT MODULE PLACED IN 180度舵机.OBJ
COMPILER INVOKED BY: D:\keil4\C51\BIN\C51.EXE 180度舵机.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /*********************************************************************************************
   2          *  程序功能：基于51单片机的舵机控制参考程序
   3          *  主要硬件：STC89C52RC单片机最小系统+180度舵机
   4          *  店铺名称：欣薇电子
   5          *  店铺网址：https://xwdzqyd.taobao.com/   
   6          *  编辑日期：2022-10-11
   7          **********************************************************************************************/
   8                  
   9          #include "reg52.h"                      //         头文件
  10          
  11          sbit Sevro_moto_pwm=P2^0;               // 舵机信号线（橙色）
  12          
  13          unsigned char pwm_val  = 0;//变量定义
  14          unsigned char push_val = 14;//舵机归中，产生约，1.5MS 信号
  15                                          
  16          
  17          void delay1ms(unsigned int k)   //延时1ms函数，k等于多少就延时多少ms
  18          {
  19   1          unsigned int a,b,c,d;
  20   1              for(d=0;d<k;d++)
  21   1              for(c=1;c>0;c--)
  22   1                  for(b=50;b>0;b--)
  23   1                      for(a=2;a>0;a--);
  24   1      }                                                                  
  25          
  26          
  27          /**********************************************************************************************
  28          **                              TIMER1中断服务子函数产生PWM信号
  29          **********************************************************************************************/
  30          
  31                  void time1()interrupt 3   using 2
  32          {       
  33   1           TH1=(65536-100)/256;         //100US定时
  34   1               TL1=(65536-100)%256;
  35   1               pwm_val++;
  36   1               if(pwm_val<=push_val)    
  37   1                     Sevro_moto_pwm=1;   //PWM信号高电平时间
  38   1              else 
  39   1                     Sevro_moto_pwm=0;   //PWM信号高电平时间
  40   1              if(pwm_val>=100)
  41   1              pwm_val=0;
  42   1       }
  43          
  44          
  45          
  46          /**********************************************************************************************
  47          **                                       主函数
  48          **********************************************************************************************/
  49          void main(void)
  50          {
  51   1              TMOD=0X10;
  52   1              TH1=(65536-100)/256;      //100US定时
  53   1              TL1=(65536-100)%256;
  54   1              TR1= 1;
  55   1              ET1= 1;
C51 COMPILER V9.01   180度舵_                                                             10/27/2022 08:47:38 PAGE 2   

  56   1              EA = 1;
  57   1      
  58   1          push_val=13;          //舵机归中，机器执行指令有周期，所以PWM信号有误差
  59   1              delay1ms(1000);   //延时1S让舵机转到其位置，停留一下
  60   1      
  61   1              while(1)                       /*无限循环*/
  62   1              { 
  63   2                        push_val=4;     //舵机向正转约90度，机器执行指令有周期，所以PWM信号有误差
  64   2                        delay1ms(500); //延时500MS让舵机转到其位置
  65   2      
  66   2                        push_val=22;    //舵机向反转约90度，机器执行指令有周期，所以PWM信号有误差
  67   2                        delay1ms(500);; //延时500MS让舵机转到其位置
  68   2                 }
  69   1      
  70   1              }   
  71          /**********************************************************************************************
  72          **                                        END FILE
  73          **********************************************************************************************/
  74                  


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    154    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
